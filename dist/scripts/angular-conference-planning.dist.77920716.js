"use strict";angular.module("AngularConferencePlanning",[]),angular.module("AngularConferencePlanning").directive("conferencePlanning",function(){var a=function(a,b){throw new Error("invalid event definition ("+b+") => "+JSON.stringify(a))},b=function(a){throw new Error("invalid provided options ("+a+")")},c=function(a){return a||(a={}),a.eventClasses||(a.eventClasses=function(){return[]}),a.slots||(a.slots={}),a.slots.from||(a.slots.from=8),a.slots.to||(a.slots.to=19),a.oneHourSlotSize||(a.oneHourSlotSize="200px"),_.endsWith(a.oneHourSlotSize,"px")?a.oneHourSlotSize=a.oneHourSlotSize.replace("px",""):b("bad provided oneHourSlotSize option, px size supported only"),a},d=function(a,b){var c=moment(a.from),d=moment(a.to),e=d.diff(c,"seconds");return b.oneHourSlotSize*e/3600},e=function(a,b){var c=moment(a.from),d=moment(a.from).hours(b.slots.from).minutes(0).seconds(0).milliseconds(0),e=c.diff(d,"seconds");return b.oneHourSlotSize*e/3600+60},f=function(b){var c={lanes:{},dates:{}};return _.each(b,function(b){b.from&&b.to&&b.place||a(b,"some attributes are missing");var d=moment(b.from),e=moment(b.to),f=d.format("YYYY-MM-DD"),g=e.format("YYYY-MM-DD");d.isAfter(e)&&a(b,"event.from > event.to"),f!=g||(c.lanes[f]||(c.lanes[f]={}),c.lanes[f][b.place]||(c.lanes[f][b.place]=[]),c.lanes[f][b.place].push(b)),c.dates=_.keys(c.lanes)}),c},g=function(a){a.axes={X:[]};for(var b=a.options.slots.from,c=a.options.slots.to,d=b;c>=d;)a.axes.X.push(d++)};return{scope:{events:"=",options:"="},restrict:"EA",templateUrl:"views/ConferencePlanning.html",transclude:!0,controller:["$scope",function(a){a.loadDate=function(b){b&&(a.lanes=a.model.lanes[b])},a.computeEventStyle=function(b){var c=e(b,a.options),f=d(b,a.options);return{"margin-left":c+"px",width:f+"px"}},a.$watchCollection("events",function(b){if(b&&!_.isEmpty(b)){var c=a.model=f(a.events);a.loadDate(c.dates[0])}})}],link:function(a){a.options=c(a.options),g(a)}}}),angular.module("AngularConferencePlanning").directive("event",function(){return{scope:!0,controller:["$scope",function(a){a.event=a.$parent.$parent.event}]}});